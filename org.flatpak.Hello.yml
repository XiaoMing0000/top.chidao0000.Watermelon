id: org.flatpak.Hello
runtime: org.freedesktop.Platform
runtime-version: '23.08'
sdk: org.freedesktop.Sdk
command: hello
modules:
  - name: hello
    buildsystem: simple
    build-commands:
      - install -Dm 755 -t /app/bin/ hello
      - install -Dm 644 org.flatpak.Hello.png /app/share/icons/hicolor/512x512/apps/org.flatpak.Hello.png
      - install -Dm 644 org.flatpak.Hello.desktop -t /app/share/applications

      # 从本地文件进行 copy
      - mkdir -p /app/eda
      - cp -a ./eda/* /app/eda

      # 解压文件
      - mkdir -p /app/eda/resources/app
      - tar -zxvf ./pro-editor-client.tgz -C /app/eda/resources/app
      - rm ./pro-editor-client.tgz


    sources:
      - type: script
        commands:
          - exec /app/eda/electron --no-sandbox "$@"
        dest-filename: hello
      
      # 从远端配置下载文件
      - type: file
        url: https://modules.lceda.cn/client/2.2.51.1.6934e56d.a2293c/pro-editor-client-2.2.51.1.6934e56d.a2293c.tgz
        sha256: 1a1671f80743bd4cb617f7c184db5c737eaa74112f3af5eb1f386c4ae1764705
        dest-filename: pro-editor-client.tgz

      - type: dir
        path: ./eda
        dest: eda

      - type: file
        path: org.flatpak.Hello.png

      - type: file
        path: org.flatpak.Hello.desktop


finish-args:
  - --share=network
  - --socket=x11
  - --socket=wayland
  - --device=dri
  - --filesystem=home